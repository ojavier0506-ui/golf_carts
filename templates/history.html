<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Historial - SunCarts</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container py-4">
  <h2>Historial de cambios</h2>

  <!-- Formulario de búsqueda -->
  <form method="GET" action="{{ url_for('history') }}" class="row g-3 mb-4">
    <div class="col-md-4">
      <label for="cart_id" class="form-label">Selecciona Carrito:</label>
      <select name="cart_id" id="cart_id" class="form-select">
        <option value="">Todos</option>
        {% for cart in carts %}
          <option value="{{ cart.id }}" {% if request.args.get('cart_id') == cart.id|string %}selected{% endif %}>
            {{ cart.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-4">
      <label for="date" class="form-label">Selecciona Fecha:</label>
      <input type="date" name="date" id="date" class="form-control" value="{{ request.args.get('date', '') }}">
    </div>

    <div class="col-md-4 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">Buscar</button>
    </div>
  </form>

  <!-- Resultados -->
  <h4>Resultados:</h4>
  {% if history %}
    <ul class="list-group mb-4">
      {% for entry in history %}
        <li class="list-group-item">
          <strong>{{ entry.timestamp }}</strong> — 
          Carrito <b>{{ entry.cart_name }}</b> —
          Estado: {{ entry.status }} —
          Comentario: {{ entry.comment }}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No se encontraron registros.</p>
  {% endif %}

  <!-- Botón para volver -->
  <div class="mt-4">
    <a href="{{ url_for('index') }}" class="btn btn-secondary">⬅️ Volver a la página principal</a>
  </div>

</body>
</html>
