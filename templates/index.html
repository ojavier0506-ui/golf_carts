<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Golf Cart Tracker</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .fixed-summary {
        position: fixed; top: 0; left: 0; right: 0;
        background: #f4f4f4; padding: 10px 20px; border-bottom: 2px solid #ccc;
        z-index: 1000; display: flex; flex-wrap: wrap; justify-content: flex-start; align-items: center; gap: 10px;
    }
    .fixed-summary h2 { margin: 0 20px 0 0; font-size: 1.2em; }
    .status-item { margin: 0 10px; font-size: 0.95em; cursor: pointer; background-color: #ff9800; color: white; padding: 5px 12px; border-radius: 12px; font-weight: bold; transition: background-color 0.2s; }
    .status-item:hover { background-color: #e68900; }
    body { margin-top: 150px; }
    .container { max-width: 400px; margin: auto; border: 1px solid #ccc; padding: 20px; border-radius: 8px; background: #f9f9f9; }
    label { display: block; margin-top: 10px; }
    select, textarea, button { width: 100%; margin-top: 5px; padding: 8px; }
    button { border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
    .save-btn { background: #28a745; color: white; margin-top: 10px; }
    .save-btn:hover { background: #218838; }
</style>
</head>
<body>
<h1>Golf Cart Tracker</h1>

<div class="fixed-summary">
    <h2>Status Summary:</h2>
    {% for status, count in counts.items() %}
        <div class="status-item">
            <strong data-status="{{status}}">{{status}}</strong>: <span id="count-{{status}}">{{count}}</span>
        </div>
    {% endfor %}
    <button class="save-btn" onclick="saveCart()">SAVE</button>
    <button class="save-btn" onclick="window.location.href='/history'">HISTORY</button>
    <button class="save-btn" onclick="window.location.href='/report'">REPORT</button>
    <button class="save-btn" onclick="window.location.href='/logout'">LOGOUT</button>
</div>

<div class="container">
    <label for="cart">Seleccionar Carrito:</label>
    <select id="cart" onchange="loadCart()">
        {% for cart in carts %}
            <option value="{{cart}}">{{cart}}</option>
        {% endfor %}
    </select>

    <label for="status">Status:</label>
    <select id="status">
        {% for option in status_options %}
            <option value="{{option}}">{{option}}</option>
        {% endfor %}
    </select>

    <label for="comment">Comment:</label>
    <textarea id="comment"></textarea>
</div>

<script>
function loadCart() {
    const cart = document.getElementById("cart").value;
    fetch(`/cart/${cart}`)
    .then(res => res.json())
    .then(data => {
        document.getElementById("status").value = data.status;
        document.getElementById("comment").value = data.comment;
    });
}

function saveCart() {
    const cart = document.getElementById("cart").value;
    const status = document.getElementById("status").value;
    const comment = document.getElementById("comment").value;

    const formData = new FormData();
    formData.append("cart", cart);
    formData.append("status", status);
    formData.append("comment", comment);

    fetch("/update_cart", { method: "POST", body: formData })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            for (const [status, count] of Object.entries(data.counts)) {
                const el = document.getElementById(`count-${status}`);
                if (el) el.textContent = count;
            }
            alert("Changes saved!");
        } else {
            alert("Error saving changes!");
        }
    });
}

// cargar datos iniciales del primer carrito
loadCart();
</script>
</body>
</html>
